<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Spline+Sans%3Awght%40400%3B500%3B700"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <style>
      /* Modal para pedir nombre */
      #nameModal {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      }
      #nameModalContent {
        background: #1a2b1d;
        padding: 2rem;
        border-radius: 12px;
        width: 90%;
        max-width: 360px;
        text-align: center;
      }
      #nameModal input {
        width: 100%;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        border: none;
        font-size: 1rem;
        margin-top: 1rem;
      }
      #nameModal button {
        margin-top: 1.2rem;
        background: #94e0b2;
        color: #141f18;
        font-weight: 700;
        border-radius: 9999px;
        padding: 0.5rem 1.5rem;
        border: none;
        cursor: pointer;
        font-size: 1rem;
        transition: background-color 0.3s ease;
      }
      #nameModal button:hover {
        background: #76c28a;
      }
    </style>
  </head>
  <body>
    <div
      class="relative flex size-full min-h-screen flex-col bg-[#141f18] dark group/design-root overflow-x-hidden"
      style='font-family: "Spline Sans", "Noto Sans", sans-serif;'
    >
      <div class="layout-container flex h-full grow flex-col">
        <header
          class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#2a4133] px-10 py-3"
        >
          <div class="flex items-center gap-4 text-white">
            <div class="size-4">
              <svg
                viewBox="0 0 48 48"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M36.7273 44C33.9891 44 31.6043 39.8386 30.3636 33.69C29.123 39.8386 26.7382 44 24 44C21.2618 44 18.877 39.8386 17.6364 33.69C16.3957 39.8386 14.0109 44 11.2727 44C7.25611 44 4 35.0457 4 24C4 12.9543 7.25611 4 11.2727 4C14.0109 4 16.3957 8.16144 17.6364 14.31C18.877 8.16144 21.2618 4 24 4C26.7382 4 29.123 8.16144 30.3636 14.31C31.6043 8.16144 33.9891 4 36.7273 4C40.7439 4 44 12.9543 44 24C44 35.0457 40.7439 44 36.7273 44Z"
                  fill="currentColor"
                ></path>
              </svg>
            </div>
            <h2
              class="text-white text-lg font-bold leading-tight tracking-[-0.015em]"
              id="headerTitle"
            >
              PetPal
            </h2>
          </div>
          <div class="flex flex-1 justify-end gap-8">
            <button
              class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 bg-[#2a4133] text-white gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5"
              title="Notificaciones"
            >
              <div
                class="text-white"
                data-icon="Bell"
                data-size="20px"
                data-weight="regular"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20px"
                  height="20px"
                  fill="currentColor"
                  viewBox="0 0 256 256"
                >
                  <path
                    d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z"
                  ></path>
                </svg>
              </div>
            </button>
            <div
              class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCW7DpMCv1c2oFeb0q72NbvS07GrwyabPxDsa7rLmAFKp5wLU4vtaJzIFS57kOCjUTVjcHZrgcY-fW3AHntyhziDoQxgUlC2etiiAdRdtjKFFJ4QhY6Ri7Wi4F5prUhcb6ncnhmPs5V9VICDvGMI7tnWDIGl-T3uB9iny80KYUigIhExnVNWppMv8EApw3NnwoSg7KoL-mM-jirfjeXeFC79nqi9SGI0ix9MA24TmA74WVYQuSK88GxiRbgXh4lNQJcDyUhB2MYZP0");'
            ></div>
          </div>
        </header>
        <div class="px-40 flex flex-1 justify-center py-5">
          <div
            class="layout-content-container flex flex-col max-w-[960px] flex-1 text-white"
          >
            <h2
              class="tracking-light text-[28px] font-bold leading-tight px-4 text-center pb-3 pt-5"
            >
              My Pet - <span id="petNameDisplay">...</span>
            </h2>
            <div class="flex w-full grow bg-[#141f18] @container p-4 rounded-xl border border-[#2a4133]">
              <div
                class="w-full gap-1 overflow-hidden bg-[#141f18] @[480px]:gap-2 aspect-[2/3] rounded-xl flex justify-center items-center"
              >
                <img
                  id="pet"
                  src="https://i.imgur.com/3XzKn3B.png"
                  alt="Telegotchi"
                  class="rounded-xl max-h-[300px] object-contain"
                />
              </div>
            </div>

            <!-- Stats -->
            <div class="flex flex-wrap gap-4 p-4">
              <div
                class="flex min-w-[158px] flex-1 flex-col gap-2 rounded-xl p-6 border border-[#3c5d49]"
                title="0% = lleno, 100% = hambriento"
              >
                <p class="text-white text-base font-medium leading-normal">
                  Hunger
                </p>
                <p
                  class="text-white tracking-light text-2xl font-bold leading-tight"
                  id="statHunger"
                >
                  50%
                </p>
              </div>
              <div
                class="flex min-w-[158px] flex-1 flex-col gap-2 rounded-xl p-6 border border-[#3c5d49]"
              >
                <p class="text-white text-base font-medium leading-normal">
                  Happiness
                </p>
                <p
                  class="text-white tracking-light text-2xl font-bold leading-tight"
                  id="statHappiness"
                >
                  50%
                </p>
              </div>
              <div
                class="flex min-w-[158px] flex-1 flex-col gap-2 rounded-xl p-6 border border-[#3c5d49]"
              >
                <p class="text-white text-base font-medium leading-normal">
                  Energy
                </p>
                <p
                  class="text-white tracking-light text-2xl font-bold leading-tight"
                  id="statEnergy"
                >
                  50%
                </p>
              </div>
              <div
                class="flex min-w-[158px] flex-1 flex-col gap-2 rounded-xl p-6 border border-[#3c5d49]"
              >
                <p class="text-white text-base font-medium leading-normal">
                  Cleanliness
                </p>
                <p
                  class="text-white tracking-light text-2xl font-bold leading-tight"
                  id="statCleanliness"
                >
                  50%
                </p>
              </div>
              <div
                class="flex min-w-[158px] flex-1 flex-col gap-2 rounded-xl p-6 border border-[#3c5d49]"
              >
                <p class="text-white text-base font-medium leading-normal">Money</p>
                <p
                  class="text-white tracking-light text-2xl font-bold leading-tight"
                  id="statMoney"
                >
                  $0
                </p>
              </div>
            </div>

            <!-- Botones acciones -->
            <div class="flex justify-stretch px-4 gap-4 flex-wrap">
              <button
                id="btnFeed"
                class="flex min-w-[120px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#94e0b2] text-[#141f18] text-sm font-bold leading-normal tracking-[0.015em]"
                title="Feed"
              >
                Feed üçñ
              </button>
              <button
                id="btnPlay"
                class="flex min-w-[120px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#94e0b2] text-[#141f18] text-sm font-bold leading-normal tracking-[0.015em]"
                title="Play"
              >
                Play üéÆ
              </button>
              <button
                id="btnSleep"
                class="flex min-w-[120px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#94e0b2] text-[#141f18] text-sm font-bold leading-normal tracking-[0.015em]"
                title="Sleep"
              >
                Sleep üò¥
              </button>
              <button
                id="btnClean"
                class="flex min-w-[120px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#94e0b2] text-[#141f18] text-sm font-bold leading-normal tracking-[0.015em]"
                title="Clean"
              >
                Clean üßº
              </button>
            </div>

            <!-- Tienda -->
            <h3
              class="text-white text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-8"
            >
              Store
            </h3>
            <div
              class="flex flex-wrap gap-3 px-4 pb-6"
              id="storeButtons"
            >
              <button
                data-type="food_basic"
                class="flex min-w-[140px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#94e0b2] text-[#141f18] text-sm font-bold leading-normal tracking-[0.015em]"
                title="Basic food (-Hunger) $5"
              >
                Food Basic ($5)
              </button>
              <button
                data-type="food_special"
                class="flex min-w-[140px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#94e0b2] text-[#141f18] text-sm font-bold leading-normal tracking-[0.015em]"
                title="Special food (+Happiness, -Hunger) $8"
              >
                Food Special ($8)
              </button>
              <button
                data-type="toy_basic"
                class="flex min-w-[140px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#94e0b2] text-[#141f18] text-sm font-bold leading-normal tracking-[0.015em]"
                title="Toy Basic (+Happiness) $10"
              >
                Toy Basic ($10)
              </button>
              <button
                data-type="toy_deluxe"
                class="flex min-w-[140px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#94e0b2] text-[#141f18] text-sm font-bold leading-normal tracking-[0.015em]"
                title="Toy Deluxe (+Energy) $15"
              >
                Toy Deluxe ($15)
              </button>
              <button
                data-type="collectible_statue"
                class="flex min-w-[140px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#bfa14c] text-[#141f18] text-sm font-bold leading-normal tracking-[0.015em]"
                title="Rare collectible statue $50"
              >
                Statue Collectible ($50)
              </button>
              <button
                data-type="collectible_painting"
                class="flex min-w-[140px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#bfa14c] text-[#141f18] text-sm font-bold leading-normal tracking-[0.015em]"
                title="Very rare collectible painting $100"
              >
                Painting Collectible ($100)
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal pedir nombre -->
      <div id="nameModal" style="display:none;">
        <div id="nameModalContent">
          <h2 style="color:#94e0b2; font-weight:bold; font-size:1.5rem;">¬øC√≥mo se llama tu mascota?</h2>
          <input
            type="text"
            id="petNameInput"
            placeholder="Escribe un nombre"
            maxlength="15"
            autocomplete="off"
          />
          <button id="btnSaveName">Guardar</button>
        </div>
      </div>

      <script>
        // Estad√≠sticas de 0 a 10 internas
        let hunger = 5,
          happiness = 5,
          energy = 5,
          cleanliness = 5,
          money = 0,
          stage = "egg",
          petName = "";

        // Coleccionables
        let collectibles = {
          statue: false,
          painting: false,
        };

        const petNameDisplay = document.getElementById("petNameDisplay");
        const headerTitle = document.getElementById("headerTitle");

        // Mostrar modal para pedir nombre
        const nameModal = document.getElementById("nameModal");
        const petNameInput = document.getElementById("petNameInput");
        const btnSaveName = document.getElementById("btnSaveName");

        async function loadState() {
          try {
            const keys = await Telegram.WebApp.CloudStorage.getKeys();
            const data = await Telegram.WebApp.CloudStorage.getItems(keys);
            hunger = parseInt(data.hunger) || 5;
            happiness = parseInt(data.happiness) || 5;
            energy = parseInt(data.energy) || 5;
            cleanliness = parseInt(data.cleanliness) || 5;
            money = parseInt(data.money) || 0;
            stage = data.stage || "egg";
            petName = data.petName || "";
            collectibles.statue = data.collectible_statue === "true";
            collectibles.painting = data.collectible_painting === "true";

            if (!petName) {
              showNameModal();
            } else {
              updatePetNameDisplay();
            }
            updateStatsDisplay();
            updatePetStage();
          } catch (e) {
            console.warn("No se pudo cargar estado:", e);
            showNameModal();
          }
        }

        async function saveState() {
          try {
            await Telegram.WebApp.CloudStorage.setItems({
              hunger: hunger.toString(),
              happiness: happiness.toString(),
              energy: energy.toString(),
              cleanliness: cleanliness.toString(),
              money: money.toString(),
             
