<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Tamagotchi</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            width: 100%;
            max-width: 400px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin: 20px 0;
        }
        
        h1 {
            color: #2b7de9;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .pet-container {
            background-color: #e9f5ff;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            position: relative;
        }
        
        .pet-image {
            font-size: 80px;
            margin: 10px 0;
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .stat-bar {
            width: 100%;
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .stat-fill {
            height: 100%;
            background-color: #4caf50;
        }
        
        .hunger .stat-fill {
            background-color: #ff9800;
        }
        
        .happiness .stat-fill {
            background-color: #e91e63;
        }
        
        .energy .stat-fill {
            background-color: #2196f3;
        }
        
        .cleanliness .stat-fill {
            background-color: #9c27b0;
        }
        
        .money {
            font-weight: bold;
            color: #4caf50;
            margin: 10px 0;
            font-size: 18px;
        }
        
        .buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        button {
            background-color: #2b7de9;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #1a5cb8;
        }
        
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .work-button {
            background-color: #ff9800;
        }
        
        .work-button:hover {
            background-color: #e68a00;
        }
        
        .shop-button {
            background-color: #9c27b0;
        }
        
        .shop-button:hover {
            background-color: #7b1fa2;
        }
        
        .sleep-button {
            background-color: #673ab7;
        }
        
        .sleep-button:hover {
            background-color: #5e35b1;
        }
        
        .clean-button {
            background-color: #009688;
        }
        
        .clean-button:hover {
            background-color: #00897b;
        }
        
        .shop {
            display: none;
            background-color: #f9f9f9;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .shop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .shop-item:last-child {
            border-bottom: none;
        }
        
        .collection {
            margin-top: 20px;
        }
        
        .collection-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        
        .collection-item {
            width: 50px;
            height: 50px;
            background-color: #e0e0e0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            position: relative;
        }
        
        .collection-item.owned {
            background-color: #ffeb3b;
            border: 2px solid #ffc107;
        }
        
        .collection-count {
            position: absolute;
            bottom: 2px;
            right: 2px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4caf50;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .notification.show {
            opacity: 1;
        }
        
        .notification.error {
            background-color: #f44336;
        }
        
        .pet-evolution {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            z-index: 10;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .tabs {
            display: flex;
            margin-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .tab.active {
            border-bottom: 2px solid #2b7de9;
            font-weight: bold;
        }
        
        .shop-content {
            display: none;
        }
        
        .shop-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Telegram Tamagotchi</h1>
        
        <div class="pet-container" id="petContainer">
            <div class="pet-image" id="petImage">üê£</div>
            <h2 id="petName">Beb√© Tamagotchi</h2>
            <div class="money">üí∞ $<span id="moneyAmount">50</span></div>
            
            <div class="stats">
                <div class="stat hunger">
                    <span>Hambre</span>
                    <div class="stat-bar">
                        <div class="stat-fill" id="hungerBar" style="width: 100%;"></div>
                    </div>
                </div>
                <div class="stat happiness">
                    <span>Felicidad</span>
                    <div class="stat-bar">
                        <div class="stat-fill" id="happinessBar" style="width: 100%;"></div>
                    </div>
                </div>
                <div class="stat energy">
                    <span>Energ√≠a</span>
                    <div class="stat-bar">
                        <div class="stat-fill" id="energyBar" style="width: 100%;"></div>
                    </div>
                </div>
                <div class="stat cleanliness">
                    <span>Limpieza</span>
                    <div class="stat-bar">
                        <div class="stat-fill" id="cleanlinessBar" style="width: 100%;"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="buttons">
            <button id="feedButton">Alimentar ($10)</button>
            <button id="playButton">Jugar</button>
            <button class="work-button" id="workButton">Trabajar (+$15)</button>
            <button class="sleep-button" id="sleepButton">Dormir</button>
            <button class="clean-button" id="cleanButton">Limpiar ($5)</button>
            <button class="shop-button" id="shopButton">Tienda</button>
        </div>
        
        <div class="shop" id="shop">
            <div class="tabs">
                <div class="tab active" data-tab="food">Comida</div>
                <div class="tab" data-tab="energy">Energ√≠a</div>
                <div class="tab" data-tab="cleanliness">Limpieza</div>
                <div class="tab" data-tab="collectibles">Coleccionables</div>
            </div>
            
            <div class="shop-content active" id="food-shop">
                <div class="shop-item">
                    <span>ü•ï Vegetales ($10)</span>
                    <button class="buy-item" data-type="food" data-cost="10" data-value="20">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üçé Frutas ($20)</span>
                    <button class="buy-item" data-type="food" data-cost="20" data-value="40">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üçó Pollo ($30)</span>
                    <button class="buy-item" data-type="food" data-cost="30" data-value="60">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üçî Comida r√°pida ($15)</span>
                    <button class="buy-item" data-type="food" data-cost="15" data-value="30" data-cleanliness="-10">Comprar</button>
                </div>
            </div>
            
            <div class="shop-content" id="energy-shop">
                <div class="shop-item">
                    <span>‚òï Caf√© ($20)</span>
                    <button class="buy-item" data-type="energy" data-cost="20" data-value="30">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üçµ T√© ($15)</span>
                    <button class="buy-item" data-type="energy" data-cost="15" data-value="20">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>‚ö° Bebida energ√©tica ($40)</span>
                    <button class="buy-item" data-type="energy" data-cost="40" data-value="60" data-happiness="10">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üíä Vitaminas ($50)</span>
                    <button class="buy-item" data-type="energy" data-cost="50" data-value="40" data-hunger="10">Comprar</button>
                </div>
            </div>
            
            <div class="shop-content" id="cleanliness-shop">
                <div class="shop-item">
                    <span>üßº Jab√≥n ($10)</span>
                    <button class="buy-item" data-type="cleanliness" data-cost="10" data-value="30">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üöø Champ√∫ ($20)</span>
                    <button class="buy-item" data-type="cleanliness" data-cost="20" data-value="50">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üß¥ Loci√≥n ($30)</span>
                    <button class="buy-item" data-type="cleanliness" data-cost="30" data-value="70" data-happiness="10">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üßΩ Spa de lujo ($100)</span>
                    <button class="buy-item" data-type="cleanliness" data-cost="100" data-value="100" data-happiness="20">Comprar</button>
                </div>
            </div>
            
            <div class="shop-content" id="collectibles-shop">
                <div class="shop-item">
                    <span>üèÜ Trofeo ($500)</span>
                    <button class="buy-item" data-type="collectible" data-cost="500" data-id="1">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üíé Diamante ($1000)</span>
                    <button class="buy-item" data-type="collectible" data-cost="1000" data-id="2">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üëë Corona ($2000)</span>
                    <button class="buy-item" data-type="collectible" data-cost="2000" data-id="3">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üéÆ Consola ($1500)</span>
                    <button class="buy-item" data-type="collectible" data-cost="1500" data-id="4">Comprar</button>
                </div>
                <div class="shop-item">
                    <span>üè° Casa ($5000)</span>
                    <button class="buy-item" data-type="collectible" data-cost="5000" data-id="5">Comprar</button>
                </div>
            </div>
        </div>
        
        <div class="collection">
            <h3>Tu Colecci√≥n</h3>
            <div class="collection-items" id="collectionItems">
                <!-- Los coleccionables aparecer√°n aqu√≠ -->
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <script>
        // Estado del juego
        const defaultGameState = {
            money: 50,
            hunger: 100,
            happiness: 100,
            energy: 100,
            cleanliness: 100,
            level: 1,
            xp: 0,
            collectedItems: {},
            petStage: 'baby',
            petName: 'Beb√© Tamagotchi',
            workCooldown: false,
            sleepCooldown: false,
            lastUpdate: Date.now()
        };
        
        let gameState = {...defaultGameState};
        
        // Elementos del DOM
        const petImage = document.getElementById('petImage');
        const petName = document.getElementById('petName');
        const moneyAmount = document.getElementById('moneyAmount');
        const hungerBar = document.getElementById('hungerBar');
        const happinessBar = document.getElementById('happinessBar');
        const energyBar = document.getElementById('energyBar');
        const cleanlinessBar = document.getElementById('cleanlinessBar');
        const feedButton = document.getElementById('feedButton');
        const playButton = document.getElementById('playButton');
        const workButton = document.getElementById('workButton');
        const sleepButton = document.getElementById('sleepButton');
        const cleanButton = document.getElementById('cleanButton');
        const shopButton = document.getElementById('shopButton');
        const shop = document.getElementById('shop');
        const collectionItems = document.getElementById('collectionItems');
        const notification = document.getElementById('notification');
        const petContainer = document.getElementById('petContainer');
        const tabs = document.querySelectorAll('.tab');
        const shopContents = document.querySelectorAll('.shop-content');
        
        // Configuraci√≥n de etapas de la mascota
        const petStages = {
            baby: { emoji: 'üê£', name: 'Beb√© Tamagotchi', nextXp: 50 },
            child: { emoji: 'üê•', name: 'Tamagotchi Ni√±o', nextXp: 150 },
            teen: { emoji: 'üê§', name: 'Tamagotchi Adolescente', nextXp: 300 },
            adult: { emoji: 'üêî', name: 'Tamagotchi Adulto', nextXp: null }
        };
        
        // Coleccionables disponibles
        const collectibles = [
            { id: 1, emoji: 'üèÜ', name: 'Trofeo', price: 500 },
            { id: 2, emoji: 'üíé', name: 'Diamante', price: 1000 },
            { id: 3, emoji: 'üëë', name: 'Corona', price: 2000 },
            { id: 4, emoji: 'üéÆ', name: 'Consola', price: 1500 },
            { id: 5, emoji: 'üè°', name: 'Casa', price: 5000 }
        ];
        
        // Inicializar el juego
        function initGame() {
            loadGame();
            updateUI();
            setupEventListeners();
            startGameLoop();
        }
        
        // Cargar el juego guardado
        function loadGame() {
            const savedGame = localStorage.getItem('tamagotchiGame');
            if (savedGame) {
                const parsedGame = JSON.parse(savedGame);
                
                // Calcular el tiempo transcurrido desde la √∫ltima actualizaci√≥n
                const now = Date.now();
                const timeElapsed = Math.floor((now - parsedGame.lastUpdate) / 1000); // en segundos
                
                // Aplicar degradaci√≥n basada en el tiempo transcurrido
                if (timeElapsed > 0) {
                    const minutesElapsed = Math.floor(timeElapsed / 60);
                    
                    // Degradaci√≥n por minuto transcurrido
                    parsedGame.hunger = Math.max(0, parsedGame.hunger - minutesElapsed * 2);
                    parsedGame.happiness = Math.max(0, parsedGame.happiness - minutesElapsed * 1);
                    parsedGame.energy = Math.max(0, parsedGame.energy - minutesElapsed * 1.5);
                    parsedGame.cleanliness = Math.max(0, parsedGame.cleanliness - minutesElapsed * 1.2);
                    
                    // A√±adir XP por tiempo sobrevivido
                    if (parsedGame.hunger > 0 && parsedGame.happiness > 0) {
                        parsedGame.xp += minutesElapsed;
                    }
                }
                
                parsedGame.lastUpdate = now;
                gameState = parsedGame;
            }
        }
        
        // Guardar el estado del juego
        function saveGame() {
            gameState.lastUpdate = Date.now();
            localStorage.setItem('tamagotchiGame', JSON.stringify(gameState));
        }
        
        // Configurar event listeners
        function setupEventListeners() {
            // Botones de acciones
            feedButton.addEventListener('click', feedPet);
            playButton.addEventListener('click', playWithPet);
            workButton.addEventListener('click', work);
            sleepButton.addEventListener('click', putToSleep);
            cleanButton.addEventListener('click', cleanPet);
            shopButton.addEventListener('click', toggleShop);
            
            // Tabs de la tienda
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    const tabId = tab.getAttribute('data-tab');
                    shopContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === `${tabId}-shop`) {
                            content.classList.add('active');
                        }
                    });
                });
            });
            
            // Delegaci√≥n de eventos para los botones de compra
            shop.addEventListener('click', function(e) {
                if (e.target.classList.contains('buy-item')) {
                    const type = e.target.getAttribute('data-type');
                    const cost = parseInt(e.target.getAttribute('data-cost'));
                    
                    if (type === 'collectible') {
                        const id = parseInt(e.target.getAttribute('data-id'));
                        buyCollectible(cost, id);
                    } else {
                        const value = parseInt(e.target.getAttribute('data-value'));
                        const hunger = e.target.hasAttribute('data-hunger') ? parseInt(e.target.getAttribute('data-hunger')) : 0;
                        const happiness = e.target.hasAttribute('data-happiness') ? parseInt(e.target.getAttribute('data-happiness')) : 0;
                        const cleanliness = e.target.hasAttribute('data-cleanliness') ? parseInt(e.target.getAttribute('data-cleanliness')) : 0;
                        
                        buyItem(type, cost, value, { hunger, happiness, cleanliness });
                    }
                }
            });
            
            // Guardar el juego antes de cerrar la p√°gina
            window.addEventListener('beforeunload', saveGame);
        }
        
        // Bucle principal del juego
        function startGameLoop() {
            setInterval(() => {
                // Disminuir estad√≠sticas con el tiempo
                gameState.hunger = Math.max(0, gameState.hunger - 0.5);
                gameState.happiness = Math.max(0, gameState.happiness - 0.3);
                gameState.energy = Math.max(0, gameState.energy - 0.4);
                gameState.cleanliness = Math.max(0, gameState.cleanliness - 0.3);
                
                // A√±adir un poco de XP por sobrevivir
                if (gameState.hunger > 0 && gameState.happiness > 0) {
                    gameState.xp += 0.5;
                }
                
                // Verificar evoluci√≥n
                checkEvolution();
                
                // Verificar si la mascota muri√≥
                checkPetHealth();
                
                updateUI();
                saveGame();
            }, 3000);
        }
        
        // Actualizar la interfaz de usuario
        function updateUI() {
            moneyAmount.textContent = Math.floor(gameState.money);
            hungerBar.style.width = `${Math.floor(gameState.hunger)}%`;
            happinessBar.style.width = `${Math.floor(gameState.happiness)}%`;
            energyBar.style.width = `${Math.floor(gameState.energy)}%`;
            cleanlinessBar.style.width = `${Math.floor(gameState.cleanliness)}%`;
            
            // Actualizar colores de las barras seg√∫n los valores
            updateBarColor(hungerBar, gameState.hunger, '#ff9800');
            updateBarColor(happinessBar, gameState.happiness, '#e91e63');
            updateBarColor(energyBar, gameState.energy, '#2196f3');
            updateBarColor(cleanlinessBar, gameState.cleanliness, '#9c27b0');
            
            // Deshabilitar botones seg√∫n el estado
            feedButton.disabled = gameState.money < 10 || gameState.hunger >= 100;
            cleanButton.disabled = gameState.money < 5 || gameState.cleanliness >= 100;
            workButton.disabled = gameState.workCooldown || gameState.energy <= 0;
            playButton.disabled = gameState.energy <= 0;
            sleepButton.disabled = gameState.sleepCooldown || gameState.energy >= 100;
            
            // Actualizar texto de botones
            workButton.textContent = gameState.workCooldown ? 'Descansando...' : 'Trabajar (+$15)';
            sleepButton.textContent = gameState.sleepCooldown ? 'Despertando...' : 'Dormir';
            
            // Actualizar colecci√≥n
            updateCollectionDisplay();
        }
        
        // Actualizar color de una barra seg√∫n su valor
        function updateBarColor(bar, value, midColor) {
            if (value < 30) {
                bar.style.backgroundColor = '#f44336';
            } else if (value < 70) {
                bar.style.backgroundColor = midColor;
            } else {
                bar.style.backgroundColor = '#4caf50';
            }
        }
        
        // Alimentar a la mascota
        function feedPet() {
            if (gameState.money >= 10 && gameState.hunger < 100) {
                gameState.money -= 10;
                gameState.hunger = Math.min(100, gameState.hunger + 20);
                gameState.xp += 5;
                gameState.cleanliness = Math.max(0, gameState.cleanliness - 5);
                showNotification('¬°Tu Tamagotchi ha comido! +20 de hambre, -5 de limpieza');
                updateUI();
            }
        }
        
        // Jugar con la mascota
        function playWithPet() {
            if (gameState.energy > 0) {
                gameState.happiness = Math.min(100, gameState.happiness + 15);
                gameState.energy = Math.max(0, gameState.energy - 20);
                gameState.xp += 10;
                gameState.cleanliness = Math.max(0, gameState.cleanliness - 10);
                showNotification('¬°Tu Tamagotchi se divirti√≥ jugando! +15 felicidad, -20 energ√≠a, -10 limpieza');
                updateUI();
            }
        }
        
        // Trabajar para ganar dinero
        function work() {
            if (!gameState.workCooldown && gameState.energy > 0) {
                gameState.money += 15;
                gameState.happiness = Math.max(0, gameState.happiness - 5);
                gameState.energy = Math.max(0, gameState.energy - 30);
                gameState.workCooldown = true;
                
                showNotification('+$15 por trabajar. -5 felicidad, -30 energ√≠a');
                updateUI();
                
                // Cooldown de trabajo
                setTimeout(() => {
                    gameState.workCooldown = false;
                    updateUI();
                }, 10000);
            }
        }
        
        // Poner a dormir a la mascota
        function putToSleep() {
            if (!gameState.sleepCooldown && gameState.energy < 100) {
                gameState.sleepCooldown = true;
                sleepButton.textContent = 'Durmiendo...';
                
                // Recuperar energ√≠a gradualmente
                const sleepInterval = setInterval(() => {
                    gameState.energy = Math.min(100, gameState.energy + 10);
                    updateUI();
                    
                    if (gameState.energy >= 100) {
                        clearInterval(sleepInterval);
                        gameState.sleepCooldown = false;
                        showNotification('¬°Tu Tamagotchi descans√≥ bien! Energ√≠a al m√°ximo');
                        updateUI();
                    }
                }, 2000);
            }
        }
        
        // Limpiar a la mascota
        function cleanPet() {
            if (gameState.money >= 5 && gameState.cleanliness < 100) {
                gameState.money -= 5;
                gameState.cleanliness = Math.min(100, gameState.cleanliness + 30);
                gameState.xp += 3;
                showNotification('¬°Tu Tamagotchi est√° limpio! +30 limpieza');
                updateUI();
            }
        }
        
        // Comprar √≠tem de la tienda
        function buyItem(type, cost, value, sideEffects = {}) {
            if (gameState.money >= cost) {
                gameState.money -= cost;
                
                switch (type) {
                    case 'food':
                        gameState.hunger = Math.min(100, gameState.hunger + value);
                        break;
                    case 'energy':
                        gameState.energy = Math.min(100, gameState.energy + value);
                        break;
                    case 'cleanliness':
                        gameState.cleanliness = Math.min(100, gameState.cleanliness + value);
                        break;
                }
                
                // Aplicar efectos secundarios
                if (sideEffects.hunger) gameState.hunger = Math.max(0, Math.min(100, gameState.hunger + sideEffects.hunger));
                if (sideEffects.happiness) gameState.happiness = Math.max(0, Math.min(100, gameState.happiness + sideEffects.happiness));
                if (sideEffects.cleanliness) gameState.cleanliness = Math.max(0, Math.min(100, gameState.cleanliness + sideEffects.cleanliness));
                
                gameState.xp += 8;
                
                let message = `¬°${type === 'food' ? 'Comida' : type === 'energy' ? 'Energ√≠a' : 'Limpieza'} comprada! +${value} ${type}`;
                if (sideEffects.hunger) message += `, ${sideEffects.hunger > 0 ? '+' : ''}${sideEffects.hunger} hambre`;
                if (sideEffects.happiness) message += `, ${sideEffects.happiness > 0 ? '+' : ''}${sideEffects.happiness} felicidad`;
                if (sideEffects.cleanliness) message += `, ${sideEffects.cleanliness > 0 ? '+' : ''}${sideEffects.cleanliness} limpieza`;
                
                showNotification(message);
                updateUI();
            } else {
                showNotification('No tienes suficiente dinero', 'error');
            }
        }
        
        // Comprar coleccionable
        function buyCollectible(cost, id) {
            if (gameState.money >= cost) {
                if (!gameState.collectedItems[id]) {
                    gameState.money -= cost;
                    gameState.collectedItems[id] = 1;
                    gameState.xp += 50;
                    showNotification('¬°Coleccionable adquirido! +50 XP');
                    updateUI();
                } else {
                    gameState.money -= cost;
                    gameState.collectedItems[id]++;
                    gameState.xp += 20;
                    showNotification(`¬°Otro ${collectibles.find(c => c.id === id).name} para tu colecci√≥n! +20 XP`);
                    updateUI();
                }
            } else {
                showNotification('No tienes suficiente dinero', 'error');
            }
        }
        
        // Mostrar/ocultar tienda
        function toggleShop() {
            shop.style.display = shop.style.display === 'block' ? 'none' : 'block';
        }
        
        // Verificar evoluci√≥n de la mascota
        function checkEvolution() {
            if (gameState.petStage === 'adult') return;
            
            const currentStage = petStages[gameState.petStage];
            
            if (gameState.xp >= currentStage.nextXp) {
                // Evolucionar a la siguiente etapa
                let nextStage;
                
                if (gameState.petStage === 'baby') nextStage = 'child';
                else if (gameState.petStage === 'child') nextStage = 'teen';
                else if (gameState.petStage === 'teen') nextStage = 'adult';
                
                if (nextStage) {
                    gameState.petStage = nextStage;
                    gameState.petName = petStages[nextStage].name;
                    
                    // Mostrar animaci√≥n de evoluci√≥n
                    showEvolutionAnimation(petStages[nextStage].emoji);
                    
                    showNotification(`¬°Tu Tamagotchi ha evolucionado a ${petStages[nextStage].name}!`);
                }
            }
        }
        
        // Verificar salud de la mascota
        function checkPetHealth() {
            if (gameState.hunger <= 0 || gameState.happiness <= 0 || gameState.energy <= 0 || gameState.cleanliness <= 0) {
                petImage.textContent = 'üíÄ';
                petName.textContent = 'RIP Tamagotchi';
                showNotification('¬°Tu Tamagotchi ha muerto! Recarga la p√°gina para empezar de nuevo.', 'error');
                return true;
            }
            return false;
        }
        
        // Mostrar animaci√≥n de evoluci√≥n
        function showEvolutionAnimation(newEmoji) {
            const evolutionDiv = document.createElement('div');
            evolutionDiv.className = 'pet-evolution';
            evolutionDiv.innerHTML = `
                <div class="pet-image">${newEmoji}</div>
                <h2>¬°Evolucionando!</h2>
                <p>${gameState.petName}</p>
            `;
            
            petContainer.appendChild(evolutionDiv);
            
            // Eliminar la animaci√≥n despu√©s de 3 segundos
            setTimeout(() => {
                petContainer.removeChild(evolutionDiv);
                petImage.textContent = newEmoji;
                petName.textContent = gameState.petName;
            }, 3000);
        }
        
        // Actualizar visualizaci√≥n de la colecci√≥n
        function updateCollectionDisplay() {
            collectionItems.innerHTML = '';
            
            collectibles.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = `collection-item ${gameState.collectedItems[item.id] ? 'owned' : ''}`;
                itemDiv.textContent = item.emoji;
                itemDiv.title = gameState.collectedItems[item.id] ? `${item.name} (x${gameState.collectedItems[item.id]})` : '???';
                
                if (gameState.collectedItems[item.id]) {
                    const countDiv = document.createElement('div');
                    countDiv.className = 'collection-count';
                    countDiv.textContent = gameState.collectedItems[item.id];
                    itemDiv.appendChild(countDiv);
                }
                
                collectionItems.appendChild(itemDiv);
            });
        }
        
        // Mostrar notificaci√≥n
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.className = 'notification';
            
            if (type === 'error') {
                notification.classList.add('error');
            } else {
                notification.classList.remove('error');
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Iniciar el juego cuando se cargue la p√°gina
        window.addEventListener('load', initGame);
    </script>
</body>
</html>
